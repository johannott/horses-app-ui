<form>
  <div class="row align-items-center">
    <div class="form-group form-inline tracks-search col-sm">
      <input class="form-control" type="text" name="searchTerm" [(ngModel)]="service.searchTerm"/>
      <span class="ml-3" *ngIf="service.loading$ | async">Loading...</span>
  </div>
  <div class="col-sm"><button class="btn btn-primary float-right" data-toggle="modal" data-target="#addTrackModalCenter">Add Track</button></div>
  </div>
  <div *ngIf="isLoading" style="text-align: center;">
    <app-loading-spinner></app-loading-spinner>
  </div>
  <table *ngIf="!isLoading" class="table table-sm table-striped">
      <thead class="thead-dark">
        <tr>
          <th scope="col" sortable="track_name" (sort)="onSort($event)">Track</th>
          <th scope="col" sortable="direction" (sort)="onSort($event)">Direction</th>
          <th scope="col" sortable="topography" (sort)="onSort($event)">Topography</th>
          <th scope="col" sortable="notes" (sort)="onSort($event)">Notes</th>
          <th scope="col" sortable="length" (sort)="onSort($event)">Length</th>
          <th scope="col" sortable="surface" (sort)="onSort($event)">Surface</th>
          <th scope="col" sortable="country" (sort)="onSort($event)">Country</th>
          <!-- <th scope="col">Update</th> -->
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let track of tracks$ | async">
          <td><ngb-highlight [result]="track.track_name" [term]="service.searchTerm"></ngb-highlight></td>
          <td><ngb-highlight [result]="track.direction" [term]="service.searchTerm"></ngb-highlight></td>
          <td><ngb-highlight [result]="track.topography" [term]="service.searchTerm"></ngb-highlight></td>
          <td><ngb-highlight [result]="track.notes" [term]="service.searchTerm"></ngb-highlight></td>
          <td><ngb-highlight [result]="track.surface" [term]="service.searchTerm"></ngb-highlight></td>
          <td><ngb-highlight [result]="track.country" [term]="service.searchTerm"></ngb-highlight></td>
          <!-- <td><button class="btn btn-link" routerLink="/updatehorse/{{horse.horse_name}}">Update</button></td> -->
        </tr>
      </tbody>
    </table>

    <div class="d-flex justify-content-between p-2">
      <ngb-pagination
        [collectionSize]="total$ | async" [(page)]="service.page" [pageSize]="service.pageSize">
      </ngb-pagination>
  
      <select class="custom-select" style="width: auto" name="pageSize" [(ngModel)]="service.pageSize">
        <option [ngValue]="20">20 items per page</option>
        <option [ngValue]="40">40 items per page</option>
        <option [ngValue]="60">60 items per page</option>
      </select>
    </div>

</form>
  
<!-- Modal -->
<div class="modal fade" id="addTrackModalCenter" tabindex="-1" role="dialog" aria-labelledby="addTrackModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalCenterTitle">Add Track</h5>
        <button type="button" class="close" #closebutton data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
          <div class="alert alert-danger" *ngIf="error">
              <p>{{ error }}</p>
         </div>
         <form #trackForm="ngForm" (ngSubmit)="onSubmit(trackForm)">
             <div class="form-group">
                 <label for="name">Track</label>
                 <input 
                     type="text" 
                     id="track_name" 
                     class="form-control"
                     ngModel
                     name="track_name">
             </div>
             <div class="form-group">
                <label for="name">Direction</label>
                <input 
                    type="text" 
                    id="direction" 
                    class="form-control"
                    ngModel
                    name="direction"
                    required>
             </div>
             <div class="form-group">
                <label for="name">Topography</label>
                <input 
                    type="text" 
                    id="topography" 
                    class="form-control"
                    ngModel
                    name="topography"
                    required>
            </div>
            <div class="form-group">
                <label for="name">Notes</label>
                <input 
                    type="text" 
                    id="notes" 
                    class="form-control"
                    ngModel
                    name="notes"
                    required>
            </div>
            <div class="form-group">
              <label for="name">Length</label>
              <input 
                  type="text" 
                  id="length" 
                  class="form-control"
                  ngModel
                  name="length"
                  required>
            </div>
            <div class="form-group">
              <label for="name">Surface</label>
              <input 
                  type="text" 
                  id="surface" 
                  class="form-control"
                  ngModel
                  name="surface"
                  required>
            </div>
            <div class="form-group">
              <label for="name">Country</label>
              <input 
                  type="text" 
                  id="country" 
                  class="form-control"
                  ngModel
                  name="country"
                  required>
            </div>
             <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" type="submit" [disabled]="!trackForm.valid">Add Track</button>
              </div>
        </form>
      </div>
    </div>
  </div>
</div>